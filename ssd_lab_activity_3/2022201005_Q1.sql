select concat(e.Fname," ",e.Minit," ",e.Lname) as "Full Name", e.Ssn, e.Dno, d.Dname from EMPLOYEE as e, DEPARTMENT d where e.Ssn in (select Mgr_ssn from DEPARTMENT where Dnumber in (select distinct Dnum from PROJECT where Pnumber in (select distinct Pno from WORKS_ON where Essn in (select Tb.Essn from (select Essn, Pno, IFNULL(Hours,0) as Hours from WORKS_ON) as Tb group by Tb.Essn having sum(Hours)<40)))) and e.Dno=d.Dnumber;
